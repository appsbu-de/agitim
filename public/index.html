<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <!-- @ifdef DEBUG -->
    <script type="text/javascript" src="agitim.js"></script>
    <!--@endif -->
    <!-- @ifdef BUILD -->
    <script type="text/javascript" src="all.min.js"></script>
    <!--@endif -->


</head>
<body>
<div id="settings">
    <select name="participants" id="participants">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
    </select>
    <select name="duration" id="duration">
        <option value="30">00:30</option>
        <option value="60">01:00</option>
        <option value="120">02:00</option>
        <option value="300">05:00</option>
        <option value="600">10:00</option>
        <option value="900">15:00</option>
        <option value="1800">30:00</option>
        <option value="3600">60:00</option>
    </select>
</div>
<div id="counter">0
</div>
<div id="counterTotal">0
</div>
<button id="action">Start</button>
<button id="next">Next</button>
<script>

    var timer = new Timer(),
        timerTotal = new Timer(),
        agile = new Agile(),
        isRunning = false,
        sbDuration = document.getElementById('duration'),
        sbParticipants = document.getElementById('participants'),
        actionButton =  document.getElementById('action'),
        formattedTime = timer.getFormatedTime(0),
        timerElement = document.getElementById('counter'),
        timerTotalElement = document.getElementById('counterTotal');

    timerElement.innerHTML = formattedTime;
    timerTotalElement.innerHTML = formattedTime;

    timer.renderTime = true;
    timer.setTimerElement(timerElement);

    timerTotal.renderTime = true;
    timerTotal.setTimerElement(timerTotalElement);

    sbDuration.onchange = sbParticipants.onchange = function() {
        setTimer();
    };

    actionButton.onclick = function() {
        timer.start();
        timerTotal.start();
    };



    function setTimer() {

        var totalTime = sbDuration.value;

        agile.setNumParticipants(sbParticipants.value);
        agile.setDuration(totalTime);

        var timePerSpeaker = Math.ceil(agile.calculateSpeakingTime());

        timer.setCountdown(timePerSpeaker);
        timerTotal.setCountdown(totalTime);
        renderTimerElement(timePerSpeaker, totalTime);
    }

    function renderTimerElement(timeToSpeak, total) {
        timerElement.innerHTML = timer.getFormatedTime(timeToSpeak);
        timerTotalElement.innerHTML = timerTotal.getFormatedTime(total);
    }

</script>
</body>
</html>